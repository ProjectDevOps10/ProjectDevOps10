name: ğŸ§ª Test AWS Connection

on:
  workflow_dispatch:
  push:
    branches: [ main ]
    paths: [ '.github/workflows/test-aws-connection.yml' ]

env:
  AWS_REGION: eu-central-1

jobs:
  test-aws:
    name: ğŸ§ª Test AWS Connection
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
    - name: ğŸ“¥ Checkout code
      uses: actions/checkout@v4
      
    - name: ğŸ” Configure AWS credentials
      uses: aws-actions/configure-aws-credentials@v4
      with:
        aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
        aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        aws-region: ${{ env.AWS_REGION }}
        
    - name: ğŸ” Test AWS CLI
      run: |
        echo "ğŸ§ª Testing AWS CLI connectivity..."
        
        # Test basic AWS CLI
        echo "ğŸ“Š AWS Account Info:"
        aws sts get-caller-identity
        
        # Test S3 access
        echo "ğŸ³ Testing S3 access:"
        aws s3 ls || echo "âš ï¸ S3 access failed (this might be expected)"
        
        # Test ECR access
        echo "ğŸ—ï¸ Testing ECR access:"
        aws ecr describe-repositories --region ${{ env.AWS_REGION }} || echo "âš ï¸ ECR access failed (this might be expected)"
        
        echo "âœ… AWS connection test completed!"
        
    - name: ğŸ“‹ Test Summary
      run: |
        echo "ğŸ‰ AWS Connection Test Summary:"
        echo "   âœ… AWS credentials loaded"
        echo "   âœ… AWS CLI working"
        echo "   âœ… Region: ${{ env.AWS_REGION }}"
        echo "   ğŸš€ Ready for deployment workflows!"
